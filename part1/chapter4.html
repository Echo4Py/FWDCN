<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="description" content="Flask Web Development" />
<meta name="keywords" content="Flask, Flask Web, Flask Web Development" />
<!--<meta name="robots" content="noindex,nofollow" />-->
<title>Chapter4</title>
<link type="text/css" rel="stylesheet" href="../css/forscreen.css" media="screen" />
<link rel="stylesheet" type="text/css" href="" media="print" />
<link rel="stylesheet" type="text/css" href="" media="handheld" />
</head>
<body>
<h1>Web表格</h1>
<p>
请求对象，在第二章介绍了，曝光了客户端发送的所有信息，发送的信息都带有一个请求。在细节上，request.form提供入口到在POST请求中提交的表格数据。
</p>
<p>
尽管在Flask的请求对象中所提供的支持对于web表格的处理是有意义的，这有一组任务数字变得单调乏味和重复。2个优良的示例是HTML代码产生给表格和提交表格数据的验证。
</p>
<p>
<a href="http://pythonhosted.org/Flask-WTF/" target=_blank>Flask-WTF</a>扩展与web表格一起工作是一个更令人高兴的经历。这个扩展是一个Flask集成包，围绕着框架不可知的<a href="http://wtforms.readthedocs.io/en/latest/" target=_blank>WTForms</a>包。
</p>
<p>
Flask-WTF和它自己的依赖能被用pip安装：
</p>
<textarea rows=3 cols=45 readonly="readonly" wrap="physical">
(venv) $ pip install flask-wtf
</textarea>
<fieldset id="f31">
<legend>交叉地点请求伪造（CSRF）保护</legend>
<p>
默认下，Flask-WTF保护所有表格防御Cross-Site Request Forgery交叉地点请求伪造（CSRF）攻击。当一个恶意网站发送请求到一个不同的受害者登录的网站上，一个CSRF攻击就会发生。
</p>
<p>
为了执行CSRF保护，Flask-WTF需要应用程序配置一个加密钥匙。Flask-WTF使用这个钥匙来产生加密过的token（语言符号），token被用来核实表单数据请求的真实性。示例4-1展示如何配置一个加密的钥匙。
</p>
<p>
示例4-1. hello.py：Flask-WTF配置<br />
<textarea rows=3 cols=45 readonly="readonly" wrap="physical">
app = Flask(__name__)
app.config['SECRET_KEY'] = 'hard to guess string'
</textarea>
</p>
<p>
这个app.config字典是一个普通目的的位置用来放置存储配置变量，配置变量被框架，扩展，或者应用程序本身使用。使用标准字典语法配置的值能被增加到app.config对象。配置对象也有方法来导入配置值，从文件中或者环境中导入。
</p>
<p>
这个SECRET_KEY配置变量被用作一个普通目的的加密钥匙，这个变量被Flask和一些第三方扩展使用。作为它名字的含义，加密的强度依赖于这个变量的值是机密的。在每一个应用程序中挑选一个不同机密的钥匙，这个机密钥匙是你建立并且确认这个字符串是不被任何人知道的。
</p>
<p>
<img src="../imgs/note.png" alt="a general note" />为了附加的安全，机密钥匙应该被存储在一个环境变量里，从而代替嵌入在代码里。这项技术在<a href="../part1/chapter7.html#">第七章</a>中被描述。
</p>
</fieldset>
<fieldset id="f32">
<legend>表格类</legend>
<p>
当使用Flask-WTF时，每一个web表格通过一个从Form类继承了的类表现出来。这个类定义了表单里的区域列表，每个被一个对象表现出来的。每个区域对象能有一个或多个验证者附着上；验证者是函数，这函数检查通过用户提交的输入是否合法。
</p>
<p>
示例4-2展示一个简单web表格，这个表格有一个文本区域和一个提交按钮。
</p>
<p>
示例4-2. hello.py：表格类定义<br />
<textarea rows=3 cols=45 readonly="readonly" wrap="physical">
from flask.ext.wtf import Form
from wtforms import StringField, SubmitField
from wtforms.validators import Required

class NameForm(Form):
    name = StringField('What is your name?', validators=[Required()])
    submit = Submitfield('Submit')
</textarea>
</p>
<p>
在表格中的区域被定义成类变量，并且每个类变量被分配给一个带有区域类型的对象。在前面示例中，NameForm表格有一个名叫name的文本区域以及一个叫做submit的提交按钮。StringField类表现了一个带有一个type="text"属性的&lt;input&gt;元素。SubmitField类表现了一个带有一个type="submit"属性的&lt;input&gt;元素。第一个针对区域构造器自变量是标签，这个标签在把表格翻译成HTML时被使用。
</p>
<p>
选项validators自变量包括在StringField构造器中，StringField构造器定义了一个检验器列表，这个检验器列表在被接收以前将被应用到被用户提交的数据中。Required()验证器保证了输入区域不会空着被提交。
</p>
<p>
<img src="../imgs/note.png" alt="a general note" />Form基础类被Flask-WTF扩展定义，所以Form是从flask.ext.wtf导入的。输入区域和验证器，不管怎么样都是从WTForms包裹中被直接导入的。
</p>
<p>
标准的HTML区域列表被WTForms支持着，这个列表展示在Table4-1中。
</p>
<table id="t4" class="tables">
<caption>Table4-1. WTForms标准HTML区域</caption>
<tr>
	<th>Field type</th>
	<th>Description</th>
</tr>
<tr>
	<td>StringField</td>
	<td>Text field</td>
</tr>
<tr>
	<td>TextAreaField</td>
	<td>Multiple-line text field</td>
</tr>
<tr>
	<td>PasswordField</td>
	<td>Password text field</td>
</tr>
<tr>
	<td>HiddenField</td>
	<td>Hidden text field</td>
</tr>
<tr>
	<td>DateField</td>
	<td>Text field that accepts a datetime.date value in a given format</td>
</tr>
<tr>
	<td>DateTimeField</td>
	<td>Text field that accepts a datetime.datetime value in a given format</td>
</tr>
<tr>
	<td>IntegerField</td>
	<td>Text field that accepts an integer value</td>
</tr>
<tr>
	<td>Decimalfield</td>
	<td>Text field that accepts a decimal.Decimal value</td>
</tr>
<tr>
	<td>FloatField</td>
	<td>Text field that accepts a floating-point value</td>
</tr>
<tr>
	<td>Booleanfield</td>
	<td>Checkbox with True and Fales values</td>
</tr>
<tr>
	<td>RadioField</td>
	<td>List of radio buttons</td>
</tr>
<tr>
	<td>SelectField</td>
	<td>Drop-down list of choices</td>
</tr>
<tr>
	<td>SelectMulitpleField</td>
	<td>Drop-down list of choices with multiple selection</td>
</tr>
<tr>
	<td>FileField</td>
	<td>File upload field</td>
</tr>
<tr>
	<td>SubmitField</td>
	<td>Form submission button</td>
</tr>
<tr>
	<td>FormField</td>
	<td>Embed a form as a field in a container form</td>
</tr>
<tr>
	<td>FieldList</td>
	<td>List of fields of a given type</td>
</tr>
</table>
<p>
WTForms内置验证器列表展示在Table4-2中。
</p>
<table id="t5" class="tables">
<caption>Table 4-2. WTForms验证器</caption>
<tr>
	<th>Validator</th>
	<th>Description</th>
</tr>
<tr>
	<td>Email</td>
	<td>Validates an email address</td>
</tr>
<tr>
	<td>EqualTo</td>
	<td>Compares the values of two fields;useful when requesting a password to be entered twice for confirmation</td>
</tr>
<tr>
	<td>IPAddress</td>
	<td>Validates an IPv4 network address</td>
</tr>
<tr>
	<td>Length</td>
	<td>Validates the length of the string entered</td>
</tr>
<tr>
	<td>NumberRange</td>
	<td>Validates that the value entered is within a numeric range</td>
</tr>
<tr>
	<td>Optional</td>
	<td>Allows empty input on the field, skipping additional validators</td>
</tr>
<tr>
	<td>Required</td>
	<td>Validates that the field contains data</td>
</tr>
<tr>
	<td>Regexp</td>
	<td>Validates the input against a regular expression</td>
</tr>
<tr>
	<td>URL</td>
	<td>Validates a URL</td>
</tr>
<tr>
	<td>AnyOf</td>
	<td>Validates that the input is one of a list of possible values</td>
</tr>
<tr>
	<td>NoneOf</td>
	<td>Validates that the input is none of a list of possible values</td>
</tr>
</table>
<p class="personal">
看到这里，自己对form和table有了一个理解，form在翻译中是表格的意思，但在实际表现出来中发现table更倾向于我们生活中制作的表格的样式。从form的内容中我发现更倾向于表单的一种功能，所以这里让我了解到表单与表格可以说是在一个范畴中的不同类型，表单更具备动态的特性，可以实现提交输入的数据，表格更倾向一种静态的展示效果，把数据以表格形式显示出来。
</p>
</fieldset>
<fieldset id="f33">
<legend>表格的HTML翻译</legend>
<p>

</p>
</fieldset>

</body>
</html>
